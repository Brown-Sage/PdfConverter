<!DOCTYPE html>
<html lang="en">
<head>
    <!-- ... (previous head content) ... -->
</head>
<body>
    <!-- ... (previous body content) ... -->
    <script>
        // ... (previous script content) ...

        function uploadFile(file, i) {
            var formData = new FormData()
            formData.append('file', file)
            document.getElementById('status').innerHTML = 'Converting...';
            fetch('/.netlify/functions/convert', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                return response.blob();
            })
            .then(blob => {
                if (blob.size === 0) {
                    throw new Error('Received empty PDF');
                }
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.style.display = 'none';
                a.href = url;
                a.download = 'converted.pdf';
                document.body.appendChild(a);
                a.click();
                window.URL.revokeObjectURL(url);
                document.getElementById('status').innerHTML = 'Conversion complete! PDF downloaded.';
            })
            .catch((error) => {
                console.error('Error:', error);
                document.getElementById('status').innerHTML = `Conversion failed: ${error.message}. Please try again.`;
            });
        }

        // ... (rest of the script content) ...
    </script>
</body>
</html>
